<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><!-- #BeginTemplate "/Templates/Template.dwt" --><!-- DW6 --><head><!--LINK REL="SHORTCUT ICON" HREF="images/mesq.ico"--><!-- #BeginEditable "doctitle" --> <title>Simulating Characters</title><!-- #EndEditable --><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"></head><body bgcolor="#FFFFFF"><div id="Page" style="position:absolute; left:0px; top:0px; z-index:1; visibility: visible; width: 100%; height: 100%">   <table border="0" cellspacing="0" cellpadding="0" width="100%">    <tr> 	  <td align="left" valign="top" height="60">         <table border="0" cellspacing="0" cellpadding="0" height="60" width="300">          <tr>        		<td width="10" height="60" align="left" valign="top"> <font face="Trebuchet MS"><img src="../images/pixel.gif" width="1" height="1" alt=" " border="0"></font></td>            <td bgcolor="#FFFFFF">               <div align="left"><font face="Trebuchet MS"><a href="../manual.html"><img src="../images/mesquitesmall.gif" width="268" height="92" border="0" alt="Mesquite"></a></font></div>            </td>          </tr>		  <tr>			<td height="42" align="left" valign="top"></td>			<td height="42" align="left" valign="top"><font face="Trebuchet MS"><a href="../manual.html"><img src="../images/mesquiteLowerManual.gif" border="0"></a></font></td>		  </tr><!--	  <tr>  		    <td colspan="2" height="10"></td>		  </tr>	      <tr>		    <td colspan="2" height="15" align="center" valign="middle">			<!-- Google CSE Search Box Begins				<form id="searchbox_016202157087875381635:khljhzi-ps8" action="http://www.google.com/cse">					<input type="hidden" name="cx" value="016202157087875381635:khljhzi-ps8" />					<input type="hidden" name="cof" value="FORID:0" />					<input name="q" type="text" size="20" />					<input type="submit" name="sa" value="Search Mesquite" />				<!--<img src="http://www.google.com/coop/images/google_custom_search_smnar.gif" alt="Google Custom Search" />		  		</form>			<!-- Google CSE Search Box Ends        		    </td>		  </tr> -->        </table>      </td>	<td>        <table border="0" cellspacing="0" cellpadding="0" height="134" width="550">          <tr valign="top" height="92">            	<td width="72" align="center"  height="92" valign="top" bgcolor="#FFFFFF"><font face="Trebuchet MS"><img src="../images/fadeRight.gif" width="72" height="160"></font></td>			<td bgcolor="#99FF99"><img src="../images/introduction.gif" valign="bottom"></td>			<td align="left" valign="top" height="92" width = "160" bgcolor="#99FF99">                 <p><font face="Trebuchet MS"><span class="smallplain"><a href="../manual.html">                  Introduction</a><br>                  </span><a href="../whyMesquite.html">Why?</a><br>                  <a href="../publication.html#howToCite">How to Cite</a>                <br>                  <a href="../publication.html">Publication</a><br>                  <a href="../support.html">Support</a><br>                  <a href="../credits.html">Credits</a> </font><br>                  <font face="Trebuchet MS"><span class="smallplain"><a href="../help.html">Help</a></span></font><br>                  <a href="../Help/MesquiteFAQ.html"><font face="Trebuchet MS">FAQ</font></a><br>                   <a href="http://mesquiteproject.org"><font face="Trebuchet MS">Web Site</font></a><br>			</td>      		<td bgcolor="#99FF99"><img src="../images/basics.gif" valign="bottom"></td>			<td align="left" valign="top" height="92" width="220"  bgcolor="#99FF99">               <p><font face="Trebuchet MS"><span class="smallplain"><a href="../help.html"></a>                <a href="../managingFiles.html">Files</a></span> <br>                <span class="smallplain"><a href="../menus.html">Menus</a><br>                <a href="../windows.html">Windows</a><br>				<a href="../charts.html">Charts</a><br>                <a href="../scripting.html">Scripts/Macros</a> <br>                <a href="../modules.html">Modules</a><br>				<a href="../howMesquiteWorks.html">How</a></span></font>              </td>      		<td bgcolor="#99FF99"><img src="../images/objects.gif" valign="bottom"></td>			<td align="left" valign="top" height="92" width="260"  bgcolor="#99FF99">				<p><font face="Trebuchet MS">                <span class="smallplain"><a href="../characters.html">Characters</a></span></font><font face="Trebuchet MS"><span class="smallplain"><a href="../Taxa.html"><br>                Taxa<br>                </a></span></font><font face="Trebuchet MS"><a href="../trees.html">Trees</a><br>                <a href="../glossary.html">Glossary</a> </font></p>              <p><font face="Trebuchet MS"><em><font face="Trebuchet MS"><a href="../changes.html">New</a><br>                &nbsp;&nbsp;<a href="../changes.html">Features</a></font></em></font></p>              </td>      		<td align="left" valign="top" height="92" width="92"><font face="Trebuchet MS"><img src="../images/fadeLeft.gif" width="92" height="160"></font></td>		</tr>    	<tr>		    <td width="72" height="20"></td>		<td></td>		    <td>&nbsp;</td>            <td>&nbsp;</td>            <td>&nbsp;</td>		</tr>		</table>		</td>	</tr>  </table>  <table border="0" cellspacing="0" cellpadding="0" width="100%" height="100%">    <tr>       <td valign="top" align="left" width="110" height="100%">         <table border="0" cellspacing="0" cellpadding="0" width="142">          <tr> 			<td colspan="3" bgcolor="#99FF99"><p><font face="Trebuchet MS"><img src="../images/fadeDown.gif" width="100%" height="95" valign "top" border="0" alt=" "></font></p></td>		  </tr>          <tr>             <td width="6" bgcolor="#99FF99" height="35"></td>			<td colspan="2" bgcolor="99FF99" valign="top" height="35"><p><font face="Trebuchet MS"><a href="../toc.html">Table of</a><br> 			   &nbsp; &nbsp; <a href="../toc.html">Contents</a></font></p></td>		  </tr>		  <tr>            <td width="6" bgcolor="#99FF99" height="35"></td>            <td colspan="2" bgcolor="#99FF99" height="35"><p><font face="Trebuchet MS"><img src="../images/analyses.gif"></font></p>              </td>          </tr>          <tr bgcolor="#99FF99">             <td height="35" align="left" valign="middle" bgcolor="#99FF99">&nbsp;</td>            <td width="131" height="35" align="left" valign="middle"><p>			  <font face="Trebuchet MS">			  <a href="../CharacterEvolution/charEvolution.html">Character</a><br>			    &nbsp; <a href="../CharacterEvolution/charEvolution.html">Evolution</a> <br> <br>			  <a href="../Diversification/diversification.html">Diversification</a><br><br>			  <a href="../molecular/molecular.html">Molecular</a><br>			    &nbsp; <a href="../molecular/molecular.html">Data</a><br><br>			  <a href="../popGen/popGen.html">Gene trees</a> <br>  <br>			  <a href="RandomSimul.html">Simulations &amp;</a><br>			    &nbsp; <a href="RandomSimul.html">Randomizations</a> <br> <br>			  <a href="../continuous/continuous.html">Continuous</a><br>			    &nbsp; <a href="../continuous/continuous.html">Characters</a><br> <br>			  <a href="../otherPrograms.html">Use with</a><br>			    &nbsp; <a href="../otherPrograms.html">Other Programs</a> <br><br>			  <a href="../studies/index.html">Studies</a> </font></p></td>            <td width="5" height="35" align="left" valign="middle">&nbsp;</td>          </tr>          <tr bgcolor="#99FF99">             <td height="35" align="left" valign="middle">&nbsp;</td>            <td height="35" align="left" valign="middle">&nbsp;</td>            <td height="35" align="left" valign="middle">&nbsp;</td>          </tr>          <tr>             <td height="35" align="left" valign="middle"><font face="Trebuchet MS"><img src="../images/fadeUp.gif" width="5" height="92"></font></td>            <td height="35" align="left" valign="middle" colspan="2"><font face="Trebuchet MS"><img src="../images/fadeUp.gif" width="100%" height="92"></font></td>          </tr>        </table>      </td>      <td valign="top" width="100%" height="100%">         <table width="700" border="0" cellpadding="10" cellspacing="0">          <tr>             <td><font face="Trebuchet MS"><!-- #BeginEditable "body" -->               <h2><font face="Trebuchet MS">Character simulations and randomizations</font></h2>              <p><font face="Trebuchet MS">Mesquite can simulate and randomize                 characters to build statistical tests. On this page we give an                 overview of these features. A more in-depth account of simulation                 of DNA sequence evolution is given <a href="simDNA.html">separately</a>.</font></p>              <h4>Contents</h4>              <p>               <ul>                <li><a href="#using">Using results of simulations &amp; randomizations</a></li>                <li><a href="#simulations">Simulations of character evolution</a></li>                <li><a href="#viewing">Viewing results of simulations</a></li>                <li><a href="#randomizing">Randomizing characters</a></li>              </ul></p>              <font face="Trebuchet MS">               <h3><a name="using"></a>Using results of simulations &amp; randomizations</h3>              <p>The simulated or randomized characters can be used or stored                 in several ways:</p>              <ul>                <li>The characters can be stored into matrices in the current                   file by choosing options in the <strong>Make New Matrix from</strong>                   submenu of the Characters menu. For instance, if you choose                   Simulated Matrices on Current Tree, the matrix simulated will                   be stored in the file.</li>                <li>The characters may be used directly, at that moment, in calculations.                   For example, if you make a Bar &amp; Line Chart for Characters,                   and choose Simulated Characters as your source of characters,                   the characters will be simulated and used in the chart without                   being stored in the file.</li>                <li>A series of many data files can be saved, each one with a                   different replicate of the simulated or randomized data matrix.                   This is available through the <strong>Save Multiple Matrices</strong>                   submenu of the Character menu</li>                <li>A series of many data files can be saved in combination with                   scripting files to instruct programs such as Swofford's PAUP                   to run the files. This can be done using the <strong>Batch Architect</strong>,                   a description of which is in the page on <a href="simDNA.html">DNA                   simulations</a> and some of the <a href="../studies/index.html">Studies</a>.</li>              </ul>              </font>               <p>To replicate the results of a simulation or randomization, you                 can use the <strong>Set Seed</strong> menu item to set the random                 number seed used. If you are using the same conditions, including                 the same seed, the simulations and randomizations should be reproducable.</p>              <h3><a name="simulations"></a>Simulations of character evolution</h3>              <p>Stochastic models can be used to simulate character evolution                 along the branches of a phylogenetic tree by selecting Simulated                 Characters (to generate characters one at a time) or Simulated                 Matrices on Current Tree (to generate whole matrices, on a current                 tree in a Tree Window), or Simulated Matrices on Trees (to generate                 whole matrices, each one on a different tree from a source of                 trees). These options are available whenever characters or matrices                 might be called for, for instance when making a chart of characters                 or matrices.</p>              <p>The following are the character types and models that can be                 simulated:</p>              <ul>                <li><strong>Evolve Categorical characters</strong>. The following                   models are also discussed in the section on <a href="../CharacterEvolution/AncestralStates.html#likelihood">likelihood                   reconstructions</a>.                   <ul>                    <li><strong>Mk1 model</strong> &#8212; Single parameter model                       analogous to Jukes-Cantor. Rates of change equal for all                       types of state-to-state changes. </li>                    <li><strong>AsymmMk model</strong> &#8212; Two parameter asymmetrical                       model with differing rates of forward and backward changes.                       Forward changes are those in which state number increases                       (e.g., state 0 to state 1); backward changes are those in                       which state decreases (e.g., state 1 to state 0). One can                       specify the forward and backward rates directly, or alternatively,                       one can specify an overall rate of change in combination                       with a bias of forward versus backward. This model will                       generally be appropriate only for binary characters. You                       can also specify whether the states are the root are assumed                       to be at the equilibrium frequencies implied by the model.                       If so, then Mesquite chooses an ancestral state in the simulations                       according to the equilibrium frequencies implied by the                       bias in gains versus losses. Otherwise, Mesquite chooses                       a state with equal probabilities.</li>                  </ul>                </li>                <li><strong>Evolve DNA characters</strong>                   <ul>                    <li>See page on <a href="simDNA.html">DNA simulations</a>                       for details.</li>                  </ul>                </li>                <li><strong>Evolve Continous characters</strong>                   <ul>                    <li><strong>Brownian motion model</strong> &#8212; Model with                       a single parameter, the rate of change.</li>                  </ul>                </li>              </ul>              <p>To use these simulations, the appropriate character model must                 be defined in advance, with all of its parameters specified. Two                 models come built-in: a Jukes-Cantor model for DNA simulations,                 and a Brownian motion model for continuous variable simulations.                 If you want any other models, created them using <strong>New Character                 Model</strong> in the Characters menu.</p>              <h3><a name="viewing"></a>Viewing results of simulations </h3>              <p>Simulated characters can be used in many calculations, but if                 you want to visualize directly the results of a simulations you                 can use the <strong>Trace Character History</strong> feature available                 in the Analysis menu of the Tree Window. By default Trace Character                 History shows a reconstruction of ancestral states. Thus, if the                 character is simulated, the states at nodes shown would not be                 the &quot;true&quot; ancestral states that occurred during the                 simulation, but rather states inferred from the states given to                 the terminal taxa by the simulation. However, once Trace Character                 History is active, its Trace menu has a <strong>Character History                 Source</strong> menu item. Choose <strong>Simulate Ancestral States</strong>                 and specify the simulation. The states indicated at the nodes                 will then be the true ancestral states in the simulation. You                 can set the Seed to make the simulation equivalent to simulations                 done in other contexts.</p>              <h3><a name="randomizing"></a>Randomizing characters </h3>              <p>Existing characters can be randomized as follows:               <ul>                <li><strong>Reshuffle Character</strong> &#8212; Supplies replicate                   reshufflings of a single chosen character. In each reshuffling,                   the character states are randomly scrambled among taxa, keeping                   the frequencies of different character states fixed.</li>                <li><strong>Reshuffle States within Characters</strong>&#8212;                   Supplies matrices, each of which is a reshuffling of an existing                   matrix. The first character of the matrix is a reshuffling of                   the first character of the original matrix; the second character                   is a reshuffling of the second original character; and so on.                   You can think of this as reshuffling within each column of the                   matrix. </li>                <li><strong>Reshuffle Within Characters (Taxa Partitioned)</strong>                   &#8212; As for Reshuffle States within Characters, but respecting                   taxa partitions. Each character of the matrix is a reshuffling                   of the respective character of the original matrix, but done                   only within groups of the current taxa partition. Thus, if taxa                   have a current <a href="../taxa.html#groups">partition</a> that                   divides the taxa into Group A and Group B, then the reshuffling                   within a character first shuffles all states of the character                   among Group A taxa. Then, it shuffles states of the character                   within Group B taxa.</li>                <li><strong>Reshuffle States Within Taxa</strong> &#8212; Supplies                   matrices, each of which is a reshuffling of an existing matrix.                   Instead of reshuffling within each column, this reshuffles within                   each row. Thus, the states of each taxon are reshuffled among                   characters. This might be used, for instance, to generate DNA                   data with no phylogenetic signal that preserves the base composition                   of each taxon.</li>                <li><strong>Reshuffle Within Taxa (Char. Partitioned)</strong>                   &#8212; As for Reshuffle States within Taxa, but respecting                   character paritions. Thus, if the characters have a current                   partition that divides them into (for example) groups 28S and                   COI, then the reshuffling within a taxon first shuffles all                   states of a taxon among 28S sites, then shuffles all states                   of the taxon among COI sites.</li>                <li><strong>Bootstrap resample</strong> &#8212; Supplies matrices,                   each of which is a bootstrap resampled version of an existing                   matrix. Characters are sampled randomly from the original matrix                   and moved into the resampled matrix until it contains as many                   characters as were in the original matrix. Some of the original                   characters may by chance be sampled more than once; some may                   be not sampled at all.</li>                <li><strong>Rarefy characters</strong> &#8212; Supplies matrices,                   each of which is derived from an existing matrix by randomly                   deleting entire characters.</li>                <li><strong>Sprinkle missing</strong> &#8212; Supplies matrices,                   each of which is derived from an existing matrix by randomly                   assigning &quot;missing&quot; (? or unassigned) to cells of                   the matrix with a particular probability.</li>                <li><strong>Add noise</strong> (for continuous matrices only)                   &#8212; Available in the Character Matrix Editor under Alter/Transform,                   this adds noise to the states of all or selected cells of the                   matrix.</li>                <li> <strong>Random Fill</strong> &#8212; Available in the Alter/Transform                   of the Matrix menu of the Character Matrix Editor, it can be                   used to fill all or selected cells of the matrix with randomly                   chosen states. </li>              </ul>              <h3>&nbsp;</h3>              <!-- #EndEditable --></font></td>          </tr>        </table>        <table border="0" cellspacing="0" cellpadding="5" width="100%">          <tr>             <td align="left" valign="top">               <hr>              <p align="center"><font face="Trebuchet MS"><span class="smallplain"><a href="http://mesquiteproject.org"><font size="2">Mesquite              Home Page</font></a><font size="2"> | <a href="../manual.html">Mesquite              Manual</a></font></span></font></p>              <p><font face="Trebuchet MS"><span class="smallplain">Copyright                 &copy; 2002-2007 by <a href="http://salticidae.org/wpm/home.html">Wayne                 P. Maddison</a> and <a href="http://david.bembidion.org">David                 R. Maddison</a>.<br>&nbsp;All rights reserved.</span></font></p></td>          </tr>        </table>      </td>    </tr>  </table></div><font face="Trebuchet MS"> </font></body><!-- #EndTemplate --></html>