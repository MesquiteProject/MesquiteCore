<!--This file created 1.4.99 9:30 PM by Claris Home Page version 2.0--><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><!-- #BeginTemplate "/Templates/Template.dwt" --><!-- DW6 --><head><!--LINK REL="SHORTCUT ICON" HREF="images/mesq.ico"--><!-- #BeginEditable "doctitle" --><title>Scripting and Macros</title><!-- #EndEditable --><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"></head><body bgcolor="#FFFFFF"><div id="Page" style="position:absolute; left:0px; top:0px; z-index:1; visibility: visible; width: 100%; height: 100%">   <table border="0" cellspacing="0" cellpadding="0" width="100%">    <tr> 	  <td align="left" valign="top" height="60">         <table border="0" cellspacing="0" cellpadding="0" height="60" width="300">          <tr>        		<td width="10" height="60" align="left" valign="top"> <font face="Trebuchet MS"><img src="images/pixel.gif" width="1" height="1" alt=" " border="0"></font></td>            <td bgcolor="#FFFFFF">               <div align="left"><font face="Trebuchet MS"><a href="manual.html"><img src="images/mesquitesmall.gif" width="268" height="92" border="0" alt="Mesquite"></a></font></div>            </td>          </tr>		  <tr>			<td height="42" align="left" valign="top"></td>			<td height="42" align="left" valign="top"><font face="Trebuchet MS"><a href="manual.html"><img src="images/mesquiteLowerManual.gif" border="0"></a></font></td>		  </tr><!--	  <tr>  		    <td colspan="2" height="10"></td>		  </tr>	      <tr>		    <td colspan="2" height="15" align="center" valign="middle">			<!-- Google CSE Search Box Begins				<form id="searchbox_016202157087875381635:khljhzi-ps8" action="http://www.google.com/cse">					<input type="hidden" name="cx" value="016202157087875381635:khljhzi-ps8" />					<input type="hidden" name="cof" value="FORID:0" />					<input name="q" type="text" size="20" />					<input type="submit" name="sa" value="Search Mesquite" />				<!--<img src="http://www.google.com/coop/images/google_custom_search_smnar.gif" alt="Google Custom Search" />		  		</form>			<!-- Google CSE Search Box Ends        		    </td>		  </tr> -->        </table>      </td>	<td>        <table border="0" cellspacing="0" cellpadding="0" height="134" width="550">          <tr valign="top" height="92">            	<td width="72" align="center"  height="92" valign="top" bgcolor="#FFFFFF"><font face="Trebuchet MS"><img src="images/fadeRight.gif" width="72" height="160"></font></td>			<td bgcolor="#99FF99"><img src="images/introduction.gif" valign="bottom"></td>			<td align="left" valign="top" height="92" width = "160" bgcolor="#99FF99">                 <p><font face="Trebuchet MS"><span class="smallplain"><a href="manual.html">                  Introduction</a><br>                  </span><a href="whyMesquite.html">Why?</a><br>                  <a href="publication.html#howToCite">How to Cite</a>                <br>                  <a href="publication.html">Publication</a><br>                  <a href="support.html">Support</a><br>                  <a href="credits.html">Credits</a> </font><br>                  <font face="Trebuchet MS"><span class="smallplain"><a href="help.html">Help</a></span></font><br>                  <a href="Help/MesquiteFAQ.html"><font face="Trebuchet MS">FAQ</font></a><br>                   <a href="http://mesquiteproject.org"><font face="Trebuchet MS">Web Site</font></a><br>			</td>      		<td bgcolor="#99FF99"><img src="images/basics.gif" valign="bottom"></td>			<td align="left" valign="top" height="92" width="220"  bgcolor="#99FF99">               <p><font face="Trebuchet MS"><span class="smallplain"><a href="help.html"></a>                <a href="managingFiles.html">Files</a></span> <br>                <span class="smallplain"><a href="menus.html">Menus</a><br>                <a href="windows.html">Windows</a><br>				<a href="charts.html">Charts</a><br>                <a href="scripting.html">Scripts/Macros</a> <br>                <a href="modules.html">Modules</a><br>				<a href="howMesquiteWorks.html">How</a></span></font>              </td>      		<td bgcolor="#99FF99"><img src="images/objects.gif" valign="bottom"></td>			<td align="left" valign="top" height="92" width="260"  bgcolor="#99FF99">				<p><font face="Trebuchet MS">                <span class="smallplain"><a href="characters.html">Characters</a></span></font><font face="Trebuchet MS"><span class="smallplain"><a href="Taxa.html"><br>                Taxa<br>                </a></span></font><font face="Trebuchet MS"><a href="trees.html">Trees</a><br>                <a href="glossary.html">Glossary</a> </font></p>              <p><font face="Trebuchet MS"><em><font face="Trebuchet MS"><a href="changes.html">New</a><br>                &nbsp;&nbsp;<a href="changes.html">Features</a></font></em></font></p>              </td>      		<td align="left" valign="top" height="92" width="92"><font face="Trebuchet MS"><img src="images/fadeLeft.gif" width="92" height="160"></font></td>		</tr>    	<tr>		    <td width="72" height="20"></td>		<td></td>		    <td>&nbsp;</td>            <td>&nbsp;</td>            <td>&nbsp;</td>		</tr>		</table>		</td>	</tr>  </table>  <table border="0" cellspacing="0" cellpadding="0" width="100%" height="100%">    <tr>       <td valign="top" align="left" width="110" height="100%">         <table border="0" cellspacing="0" cellpadding="0" width="142">          <tr> 			<td colspan="3" bgcolor="#99FF99"><p><font face="Trebuchet MS"><img src="images/fadeDown.gif" width="100%" height="95" valign "top" border="0" alt=" "></font></p></td>		  </tr>          <tr>             <td width="6" bgcolor="#99FF99" height="35"></td>			<td colspan="2" bgcolor="99FF99" valign="top" height="35"><p><font face="Trebuchet MS"><a href="toc.html">Table of</a><br> 			   &nbsp; &nbsp; <a href="toc.html">Contents</a></font></p></td>		  </tr>		  <tr>            <td width="6" bgcolor="#99FF99" height="35"></td>            <td colspan="2" bgcolor="#99FF99" height="35"><p><font face="Trebuchet MS"><img src="images/analyses.gif"></font></p>              </td>          </tr>          <tr bgcolor="#99FF99">             <td height="35" align="left" valign="middle" bgcolor="#99FF99">&nbsp;</td>            <td width="131" height="35" align="left" valign="middle"><p>			  <font face="Trebuchet MS">			  <a href="CharacterEvolution/charEvolution.html">Character</a><br>			    &nbsp; <a href="CharacterEvolution/charEvolution.html">Evolution</a> <br> <br>			  <a href="Diversification/diversification.html">Diversification</a><br><br>			  <a href="molecular/molecular.html">Molecular</a><br>			    &nbsp; <a href="molecular/molecular.html">Data</a><br><br>			  <a href="popGen/popGen.html">Gene trees</a> <br>  <br>			  <a href="RandomSimul/RandomSimul.html">Simulations &amp;</a><br>			    &nbsp; <a href="RandomSimul/RandomSimul.html">Randomizations</a> <br> <br>			  <a href="continuous/continuous.html">Continuous</a><br>			    &nbsp; <a href="continuous/continuous.html">Characters</a><br> <br>			  <a href="otherPrograms.html">Use with</a><br>			    &nbsp; <a href="otherPrograms.html">Other Programs</a> <br><br>			  <a href="studies/index.html">Studies</a> </font></p></td>            <td width="5" height="35" align="left" valign="middle">&nbsp;</td>          </tr>          <tr bgcolor="#99FF99">             <td height="35" align="left" valign="middle">&nbsp;</td>            <td height="35" align="left" valign="middle">&nbsp;</td>            <td height="35" align="left" valign="middle">&nbsp;</td>          </tr>          <tr>             <td height="35" align="left" valign="middle"><font face="Trebuchet MS"><img src="images/fadeUp.gif" width="5" height="92"></font></td>            <td height="35" align="left" valign="middle" colspan="2"><font face="Trebuchet MS"><img src="images/fadeUp.gif" width="100%" height="92"></font></td>          </tr>        </table>      </td>      <td valign="top" width="100%" height="100%">         <table width="700" border="0" cellpadding="10" cellspacing="0">          <tr>             <td><font face="Trebuchet MS"><!-- #BeginEditable "body" -->               <h2>Scripting and Macros</h2>              <p>Mesquite's scripting system allows modules and other objects                 to be scripted using text commands. Mesquite uses scripting by                 text commands as follows:</p>              <font face="Trebuchet MS">               <ul>                <li>When a menu item, button, or tool is used, Mesquite sends                   a text command to the appropriate object, informing it of the                   use. This means that most user interface commands can also be                   executed in scripts and macros.                 <li>When Mesquite re-reads a NEXUS file, it attempts to return                   windows and analyses to approximately the same condition as                   when the file had been saved. It does this by reading scripting                   instructions in a <b>MESQUITE block</b> that Mesquite had written                   into the file when saved. Thus, Mesquite writes scripts called                   &quot;Snapshots&quot; to later instruct itself.                 <li>Macros are script files which, if placed in the recognized                   directories, appear in submenus as selectable menu items. When                   selected, the macro is executed. Mesquite recognizes directories                   called &quot;macros&quot; within the Mesquite_Folder directory                   and the &quot;Mesquite_Prefs&quot; subdirectory of the Mesquite_Support_Files                   directory.                 <li>Not all scripts in MESQUITE blocks need to be written by Mesquite.                   Users can write MESQUITE block scripts by hand.                 <li>Users can send a script to a window using <font size="-1"><u>Window&gt;Scripting&gt;Send                   Script</u></font>. This page gives some <a href="#examples">simple                   examples</a> for the tree window.               </ul>              </font>               <p>The text commands are sent to modules or other objects. The particular                 text commands to which a module or other object responds will                 depend on the object. When Mesquite shows a web page for the first                 time, it attempts to compile automatically documentation for scripting                 commands that is available. This includes commands predefined                 by the scripting language, and commands belonging to particular                 modules. This compiled documentation is available from the web                 page linked from the &quot;<b>Scripting Commands</b>&quot; menu                 item in the Help menu when Mesquite is running.</p>              <p>Mesquite's scripting language is not as human-friendly as it                 might be at present, especially in its handling of variables and                 aspects such as the lack of &quot;else&quot; statements. Since                 the vast majority of Mesquite scripts won't be written by humans                 but by Mesquite itself, that is not such a liability as it might                 seem. We hope to reform the scripting language in the future.</p>              <h3> <a name="macros"></a>Macros</h3>              <font face="Trebuchet MS">               <p>Scripts performing some special function can be written and distributed                 by programmers to end users as &quot;Macros&quot;. For some calculations                 or display functions, the number of different analyses a user                 might like to do are too many to be easily supported by a graphical                 user interface. For instance, the user might like to print the                 ancestral state reconstruction of a character using a series of                 different stepmatrices. One can invent many such scenarios in                 which something repetitious is needed, and a module would be hard-pressed                 to maintain each as an option. Thus, small scripts using Mesquite's                 scripting language can be written and placed in the &quot;macros&quot;                 folder. These macros will appear as options in an appropriate                 place, depending upon where they are applicable. When the user                 selects the menu item, the script is executed.</p>              <p>Macros can also be automatically composed by Mesquite. As noted                 above, Mesquite composes a script to place in NEXUS files that                 it saves. This script applies only to the particular saved file.                 In some contexts, you can ask Mesquite to save a script as a macro                 file. This is currently available in only a few contexts. Save                 Window as Macro in the Analysis menu and Window menu save macros                 that attempt to reproduce the condition (including analyses) of                 the foremost window. This is useful to reproduce a complex chart                 with a different data file, for example. Save Macro For Tree Drawing                 in the Drawing menu of a Tree Window creates a macro by which                 you can later reproduce the current appearance of the tree drawing                 (background color, font, tree form, orientation, and so on). Save                 Tree Analysis As Macro in the Tree menu of a Tree window creates                 a macro by which to reproduce a particular analysis with the tree.                 Macros so created are stored in Mesquite_Support_Files/Mesquite_Prefs/macros,                 and could be (for instance) shared by users.</p>              </font>               <h3> <a name="learning"></a>Learning about scripting</h3>              <p>Users can learn about the scripting language from this web page,                 but also by inspection of existing scripts. Some sources of scripts                 to examine are:</p>              <ul>                <li>The<b> MESQUITE block</b> within NEXUS files saved by Mesquite.                   If you want to know how to script a tree window to trace a character,                   for instance, open a tree window, turn on character tracing,                   and save the file. You can look at the file with a text editing                   program to see how such a script would be written                 <li>If there are any <b>macros</b> installed, you can examine                   the files that specify them. These files are simple text files                   with scripts. Macros would be found in folders called &quot;macros&quot;                   within the Mesquite_Folder directory, and in the macros folder                   of the &quot;Mesquite_Prefs&quot; directory of the Mesquite_Support_Files                   directory.                 <li>The menu item <font size="-1"><u>Windows&gt;Scripting&gt;Show                   Snapshot</u></font> shows a <b>snapshot</b> for the window &#8212;                   the script that would be needed to set the window to its current                   state.               </ul>              <p>Another way to learn about the language and particular scripting                 commands is to look at the web pages linked from the &quot;<b>Scripting                 Commands</b>&quot; menu item in the Help menu when Mesquite is                 running. In particular, examine the page on universal commands,                 which shows basic commands available regardless of the object                 being scripted, including the basic flow control and variable-defining                 commands of the system. (We cannot provide a link here to this                 web page because this web page is created by Mesquite when it                 runs, and is placed in a location that depends on your particular                 computer. After running Mesquite once, you may want to find some                 of these files and save a bookmark/alias/shortcut to them &#8212;                 the file on basic scripting commands is named 'puppeteer.html').</p>              <h3> <a name="commands"></a>Commands within scripts</h3>              <p>In general, a command found within a script takes the following                 form:</p>              <pre>     commandName  argument1 argument2 ...;</pre>              <p>The commandName is a single word (token); the arguments can be                 multiple tokens, so long as the module knows how to interpret                 them. Typically each argument is a single token (though this may                 be string of multiple tokens converted to a single token by quotation).</p>              <h3> <a name="scripts"></a>Scripts</h3>              <p>A script consists of a series of commands. At each stage in the                 script, there is an implicit recipient of the command given (for                 instance, a module or a window). For instance, here is a script                 within the MESQUITE block of a NEXUS file. To the right of the                 commands are comments to explain them.</p>              <pre><font size="-1">Begin MESQUITE;  getNumberOfDataSets;      [file coordinator queried for number of data sets]  Integer.dataSets *it;     [storing number of data sets in integer variable 'dataSets']  getEmployee 'Data Window Coordinator'; [querying for reference to Data Window Coordinator module]  tell It;                  [commands to follow will be sent to the Data Window Coordinator]    Integer.dataNum 0;      [Define integer variable 'dataNum' and assign it 0]    for *Integer.dataSets;  [for loop; cycle as many times as there are data sets]      showDataWindow *Integer.dataNum;  [commands to make a data window for dataset]      tell It;              [commands to follow will be sent to module that makes data window]        showWindow;         [tells the module to make the data window visible]      endTell;              [finished sending commands to the module that makes the data window]      increment.dataNum;    [add 1 to the variable 'dataNum']    endFor;                 [end of the for loop]  endTell;                  [finished sending commands to the Data Window Coordinator]  getNumberOfTaxas;         [file coordinator queried for number of sets of taxa]  Integer.taxaSets *it;     [storing number of sets of taxa in integer variable 'taxaSets']  getEmployee 'Tree Window Coordinator';  [querying for reference to Tree Window Coordinator module]  tell It;                  [commands to follow will be sent to the Tree Window Coordinator]    Integer.taxaNum 0;      [Define integer variable 'taxaNum' and assign it 0]    for *Integer.taxaSets;  [for loop; cycle as many times as there are sets of taxa]      makeTreeWindow *Integer.taxaNum;  [commands to make a tree window for set of taxa]      tell It;              [commands to follow will be sent to module that makes tree window]        getTreeWindow;      [queries the module to return a reference to the tree window itself]        tell It;            [commands to follow will be sent to the tree window]          newAssistant 'Trace Character History';  [the tree window is asked to hire a module]        endTell;            [finished sending commands to the tree window]        showWindow;         [tells the module to make the tree window visible]      endTell;              [finished sending commands to the module that makes the tree window]      increment.taxaNum;    [add 1 to the variable 'taxaNum']    endFor;                 [end of the for loop]  endTell;                  [finished sending commands to the Tree Window Coordinator]END;</font></pre>              <p>This MESQUITE block causes Mesquite to show a data window for                 each of the data sets, and a tree window for each of the Taxa                 blocks; the tree windows are shown with a character traced.</p>              <p>This script illustrates some of the features of Mesquite's scripting                 language:</p>              <ul>                <li>There is a <b>current object</b> to which commands are sent.                   Which object is being commanded can be changed by a &quot;tell&quot;                   command. Initially, the implicit recipient of the commands is                   the FileCoordinator of the file in question.                 <li>Any given command may <b>return an object</b> that is stored                   within the variable referred to by &quot;<b>It</b>&quot;. Thus,                   in the above script, the makeTreeWindow returns the module hired                   to supervise the tree window. The immediately following command,                   &quot;tell It&quot; thus shifts the recipient of commands to                   this tree window module.                 <li>The scripting language has <b>variables</b>. They are defined                   or their values set by commands beginning, for instance, Integer.myIntegerName                   or Object.myObjectName. Their values can be utilized by prefixing                   their names by an asterisk, for instance *Integer.myIntegerName.                 <li>The scripting language has <b>control flow</b>, including                   <b>if</b>, <b>for</b> loops, and <b>while</b> loops.               </ul>              <p>Some of the lines of this script are commands unique to particular                 commandable objects (getNumberDataSets, getEmployee, showDataWindow,                 etc.); others are predefined by the scripting language (e.g.,                 Integer, tell, for). More details on particular commands can be                 found in the web pages linked from the &quot;<b>Scripting Commands</b>&quot;                 menu item in the Help menu when Mesquite is running. Some details                 are found below.</p>              <p>               <h3> <a name="vars"></a>Variables: Integers, Strings and Objects</h3>              <p>Three sorts of variables are supported. Reference to each requires                 the type of variable with name appended, as in &quot;Integer.numberOfCharacters&quot;                 or &quot;Object.treeDrawCoordinator&quot;. The generic variable                 &quot;it&quot; refers to the object last returned by a command.</p>              <p>When the variable is passed as an argument for a command, it                 should be preceeded by an <b>asterisk</b>. This allows the system                 to know that a variable, and not a constant string, is being passeed.</p>              <h4> <a name="nums"></a>Numerical variables</h4>              <p>Two sorts of numerical variables are supported: Integer and Number.                 The former contain whole numbers. The latter can contain whole                 or decimal numbers. Reference to each requires the type of variable                 with name appended, as in &quot;Integer.numberOfCharacters&quot;                 or &quot;Object.treeDrawCoordinator&quot;. The generic variable                 &quot;it&quot; refers to the object last returned by a command.</p>              <p>When the variable is passed as an argument for a command, it                 should be preceeded by an asterisk. This allows the system to                 know that a variable, and not a constant string, is being passeed.                 The commands concerning variables are:</p>              <ul>                <li><b>Integer.[name] [number];</b>&#151; this declares an integer                   variable of name &quot;name&quot; and assigns it the value given                   by the number. If the variable already exists, its value is                   replaced by the number. The number may be represented by a constant,                   as in &quot;Integer.counter 5&quot;, by an integer variable,                   as in &quot;Integer.counter *Integer.previousCount&quot;, or                   by a String variable that contains a string that can be parsed                   into an integer, as in &quot;Integer.counter *String.countString&quot;.                   If the number is indicated as &quot;random&quot;, a random integer                   will be placed in the variable.                 <li><b>increment.[name of integer];</b> &#151; this adds one to                   the integer's value                 <li><b>decrement.[name of integer];</b> &#151;this subtracts one                   from the integer's value.                 <li><b>Number.[name] [number];</b>&#151; this declares a numerical                   variable of name &quot;name&quot; and assigns it the value given                   by the number. If the variable already exists, its value is                   replaced by the number. The number may be represented by a constant,                   as in &quot;Number.rate 0.5&quot;, by an integer variable, as                   in &quot;Number.rate *Number.previousRate&quot;, or by a String                   variable that contains a string that can be parsed into a number,                   as in &quot;Number.rate *String.rateString&quot;. If the number                   is indicated as &quot;random&quot;, a random number between                   0 and 1 will be placed in the variable. If the number to be                   placed into the Number variable is preceeded by a '+', the number                   doesn't replace the existing value of the Number variable, but                   is added to it (similarly for '-').               </ul>              <h4> <a name="strings"></a>String variables</h4>              <p>One sort of variable contains a string of text. The command to                 define and assign values to a string variable is:</p>              <ul>                <li><b>String.[name] [string]; </b>&#151; this declares a String                   variable of name &quot;name&quot; and assigns it the value given                   by the string. If the variable already exists, its value is                   replaced by the string, unless the string passed to it is preceded                   by &quot;+&quot; in which case it is appended to the existing                   string. The string passed may be represented by a literal string,                   as in &quot;String.name John A. MacDonald&quot;, by an String                   variable, as in &quot;String.name *String.name.firstPM&quot;,                   or by an Object variable, in which case the name of the Object                   will be used.               </ul>              <h4> <a name="objects"></a>Object variables</h4>              <p>One sort of variable contains a objects (such as modules, or                 windows). The command to define and assign values to an object                 variable is:</p>              <ul>                <li><b>Object.[name] [reference to object]; </b>&#151; this declares                   an Object variable and assigns it the object indicated. If the                   variable already exists, its value is replaced. The reference                   may be &quot;it&quot;, as in &quot;Object.thisModule *It&quot;,                   or an Object variable, as in &quot;Object.thisModule *Object.storedModule&quot;.               </ul>              <h4> <a name="it"></a>The variable &quot;It&quot;</h4>              <p>Standard Mesquite Commands to modules return an object. In the                 scripting language, this returned object is stored in the variable                 &quot;It&quot;. Thus, after a command &quot;getNumberDataSets&quot;                 to the FileCoordinator, the FileCoordinator returns an Integer                 variable containing the number of data sets. This can be stored                 in an Integer variable by following the command by &quot;Integer.numDataSets                 *it&quot;. Likewise, &quot;tell&quot; often makes use of &quot;it&quot;.</p>              <h3> <a name="flowCommand"></a>Flow and command control</h3>              <p>As noted above Mesquite's scripting language has flow control                 as well as control of the object to be commanded.</p>              <h4>Using &quot;tell&quot; to direct commands</h4>              <p>Commands are directed toward commandable objects, including modules,                 windows, and others. Since different objects might use the same                 command names, the object to which a command is directed must                 be indicated. In the scripting language, at any point there is                 an implicit object being commanded. Subsequent commands are directed                 to a different object using the &quot;tell&quot; command, which                 must be balanced by &quot;endTell&quot;. At the root level, the                 FileCoordinator is being commanded.</p>              <h4>Flow control</h4>              <p>Flow control statements include &quot;if&quot;, &quot;for&quot;,                 and &quot;while&quot;. Others are available (such as <b>ifnot</b>,                 <b>stop</b>, <b>exitTell</b>). Details on these can be found via                 the web page shown by selecting <b>Scripting Commands</b> from                 the <b>Help</b> menu while Mesquite is running.</p>              <ul>                <li><b>if</b> [integer or integer variable]; ... <b>endIf</b>;                   &#151; the statements between if and endIf are executed if the                   integer variable is non-zero                 <li><b>for</b> [integer or integer variable]; ... <b>endFor</b>;                   &#151; the statements between for and endFor are executed as                   many times as the initial value of the integer variable.                 <li><b>while</b> [integer or integer variable]; ... <b>endWhile</b>;                   &#151; the statements between while and endWhile are executed                   repeatedly as long as the value of the integer variable is non-zero.               </ul>              <h3> <a name="debugging"></a>Debugging</h3>              <p>There are a number of commands that are useful for debugging.                 For instance, if the Command &quot;debug&quot; is placed in the                 block, a debugging mode will be enabled which reports in the console                 more details about the commands as they are executed. More information                 about such commands can be found by selecting the &quot;<b>Scripting                 Commands</b>&quot; menu item under the Help menu when Mesquite                 is running.</p>              <h3><a name="examples"></a>Examples</h3>              <p>Here are three simple example scripts that you can send to the                 Tree window using <u>Window&gt;Scripting&gt;Send Script</u>. Open                 a tree window, turn on Trace Character History, and then paste                 one of these scripts into the Send Script dialog box. <strong>The                 first script scrolls from tree to tree, for each recording in                 a file &quot;results.txt&quot; the reconstruction of ancestral                 states.</strong></p>              <p>               <pre><font size="-1">String.resultsFile 'results.txt';saveMessageToFile *String.resultsFile 'RESULTS with different trees';appendReturnToFile *String.resultsFile;getWindow;tell It;	getNumTrees;	Integer.numReps *It;	ifNotCombinable *Integer.numReps;		Integer.numReps 10; [in case indefinite number of trees]	endIf;endTell;Integer.count 0;for *Integer.numReps;	increment.count;	getWindow;	tell It;		setTreeNumber *Integer.count;	endTell;	getEmployee #mesquite.ancstates.RecAncestralStates.RecAncestralStates;	tell It;		getLastResult;		String.result *It;		appendMessageToFile *String.resultsFile *String.result;		appendReturnToFile *String.resultsFile;	endTell;endFor;</font></pre>              <p><strong>This second script scrolls from character to character,                 for each recording the ancestral states in a file &quot;results.txt&quot;:</strong></p>              <pre><font size="-1">String.resultsFile 'results.txt';saveMessageToFile *String.resultsFile 'RESULTS with different characters';appendReturnToFile *String.resultsFile;getEmployee #mesquite.ancstates.RecAncestralStates.RecAncestralStates;tell It;	getNumHistories;	Integer.numReps *It;	ifNotCombinable *Integer.numReps;		Integer.numReps 10; [in case indefinite number of characters]	endIf;endTell;Integer.count 0;for *Integer.numReps;	increment.count;	getEmployee #mesquite.ancstates.TraceCharacterHistory.TraceCharacterHistory;	tell It;		setCharacter *Integer.count;	endTell;	getEmployee #mesquite.ancstates.RecAncestralStates.RecAncestralStates;	tell It;		getLastResult;		String.result *It;		appendMessageToFile *String.resultsFile *String.result;		appendReturnToFile *String.resultsFile;	endTell;endFor;</font></pre>              <p><strong>The third script scrolls from tree to tree, printing                 each one.</strong></p>              <pre><font size="-1">getWindow;tell It;	getNumTrees;	Integer.numReps *It;	ifNotCombinable *Integer.numReps;		Integer.numReps 10; [in case indefinite number of trees]	endIf;endTell;for *Integer.numReps;	getWindow;	tell It;		setTreeNumber *Integer.count;		printToFit;	endTell;endFor;</font></pre>              <h3>Technical Details</h3>              <p>(See the <a href="http://mesquiteproject.org/mesquite/development/development.html">developer's                 documentation</a>.) The Puppeteer is in charge of defining the                 basic language as it relates to variables and flow control. For                 an object to be scriptable, it must be of the Commandable interface.                 Commands internally in Mesquite are remembered in objects called                 MesquiteCommands.</p>              <p>               <p> <!-- #EndEditable --></font></td>          </tr>        </table>        <table border="0" cellspacing="0" cellpadding="5" width="100%">          <tr>             <td align="left" valign="top">               <hr>              <p align="center"><font face="Trebuchet MS"><span class="smallplain"><a href="http://mesquiteproject.org"><font size="2">Mesquite              Home Page</font></a><font size="2"> | <a href="manual.html">Mesquite              Manual</a></font></span></font></p>              <p><font face="Trebuchet MS"><span class="smallplain">Copyright                 &copy; 2002-2007 by <a href="http://salticidae.org/wpm/home.html">Wayne                 P. Maddison</a> and <a href="http://david.bembidion.org">David                 R. Maddison</a>.<br>&nbsp;All rights reserved.</span></font></p></td>          </tr>        </table>      </td>    </tr>  </table></div><font face="Trebuchet MS"> </font></body><!-- #EndTemplate --></html>